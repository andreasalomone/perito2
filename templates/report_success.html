{% extends "base_layout.html" %}

{% block content %}
<div class="success-container">

    <div class="success-icon">
        üéâ
    </div>

    <h1 style="margin-bottom: 10px;">Perizia Pronta!</h1>

    {% if generation_time %}
    <div class="time-saved-banner" style="color: var(--text-muted); font-size: 1.1rem; margin-bottom: 2rem;">
        Generata in <strong>{{ "%.1f"|format(generation_time) }}s</strong>.
        Hai risparmiato circa <strong>2 ore</strong> di lavoro manuale.
    </div>
    {% endif %}

    {% if api_cost_usd is not none %}
    <div class="cost-banner"
        style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 2rem; margin-top: -1rem;">
        Questa perizia √® costata <strong>${{ "%.2f"|format(api_cost_usd) }} USD</strong>
    </div>
    {% endif %}

    <div class="file-card">
        <img src="{{ url_for('static', filename='icons/docx-icon.svg') }}" alt="DOCX"
            style="width: 48px; height: 48px;">
        <div style="text-align: left;">
            <div style="color: var(--text-color); font-weight: bold; font-size: 1.1rem;">Perizia_{{ report_id[:8]
                }}.docx</div>
            <div style="color: var(--primary-color); font-size: 0.9rem;">Pronta per il download</div>
        </div>
    </div>

    <form action="{{ url_for('download_report', report_id=report_id) }}" method="get" class="download-form">
        <div class="format-selection" style="margin-bottom: 1.5rem; text-align: left; background: var(--bg-secondary); padding: 1rem; border-radius: 8px;">
            <div style="margin-bottom: 0.5rem; font-weight: bold; color: var(--text-color);">Seleziona Intestazione:</div>
            <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                    <input type="radio" name="format" value="bn_surveys" checked>
                    <span>BN Surveys</span>
                </label>
                <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                    <input type="radio" name="format" value="salomone">
                    <span>Salomone & Associati</span>
                </label>
            </div>
        </div>

        <button type="submit" class="btn-download">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
            Scarica e Modifica in Word
        </button>
    </form>

    <a href="{{ url_for('index') }}" class="link-secondary">
        ‚Üê Carica un'altra pratica
    </a>

</div>
{% endblock %}